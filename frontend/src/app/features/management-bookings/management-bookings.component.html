<div
  class="breadcrumb-card mb-25 d-md-flex align-items-center justify-content-between"
>
  <h5 class="mb-0">Reservas</h5>
  <ol class="breadcrumb list-unstyled mt-0 mb-0 pl-0">
    <li class="breadcrumb-item position-relative">
      <a routerLink="/" class="d-inline-block position-relative">
        <i class="ri-settings-3-fill"></i>
        <span>Administración</span>
      </a>
    </li>
    <li class="breadcrumb-item position-relative">
      {{ selectedEduSpace ? "Reservas" : "Pre-Reservas" }}
    </li>
  </ol>
</div>

@if (!selectedEduSpace) {
<div class="row">
  <div class="col-lg-12">
    <mat-card
      class="daxa-card mb-25 border-radius bg-white border-none d-block"
    >
      <mat-card-content class="example-alerts">
        <div class="alert alert-outline-info" role="alert">
          Seleccione un espacio educativo para gestionar sus reservas.
        </div>
      </mat-card-content>
    </mat-card>
  </div>
  @for (eduSpace of (eduSpaces$ | async); track $index) {
  <div class="col-lg-4 col-md-6">
    <shared-card-educational-space
      [eduSpaceData]="eduSpace"
      (selectedEduSpace)="onSelectedEduSpace($event)"
    ></shared-card-educational-space>
  </div>
  }
</div>
}
<!--  -->
@if (selectedEduSpace) {
<div class="row">
  <div class="col-lg-12">
    <mat-card
      class="daxa-card mb-20 border-radius bg-white border-none d-block"
    >
      <mat-tab-group dynamicHeight>
        <!-- [(selectedIndex)]="activeTabIndex" -->
        <!-- (selectedTabChange)="changeTab($event)" -->

        <mat-tab label="Tabla" [tabIndex]="0">
          <div class="row">
            <div class="col-lg-12">
              <mat-card
                class="daxa-card mb-20 border-radius bg-white border-none d-block"
              >

                <mat-card-content>
                  <div [class.component-dark-theme]="themeService.isDark()">
                    @if(isLoading) {
                    <mat-progress-bar mode="query"></mat-progress-bar>
                    }

                    <div class="splitter-table-container" tabindex="0">
                      <table mat-table [dataSource]="(dataSource$ | async)!">
                        <ng-container matColumnDef="name">
                          <th mat-header-cell *matHeaderCellDef>Fecha</th>
                          <td mat-cell *matCellDef="let element">
                            {{ element.name }}
                          </td>
                        </ng-container>

                        <ng-container matColumnDef="lastName">
                          <th mat-header-cell *matHeaderCellDef>Hora Ingreso</th>
                          <td mat-cell *matCellDef="let element">
                            {{ element.lastName }}
                          </td>
                        </ng-container>

                        <ng-container matColumnDef="email">
                          <th mat-header-cell *matHeaderCellDef>Hora Salida</th>
                          <td mat-cell *matCellDef="let element">
                            {{ element.email }}
                          </td>
                        </ng-container>

                        <ng-container matColumnDef="phoneNumber">
                          <th mat-header-cell *matHeaderCellDef>Docente</th>
                          <td mat-cell *matCellDef="let element">
                            {{ element.phoneNumber }}
                          </td>
                        </ng-container>

                        <ng-container matColumnDef="roles">
                          <th mat-header-cell *matHeaderCellDef># estudiantes</th>
                          <td mat-cell *matCellDef="let element">
                            <span [sharedMaxWidthEllipsis]="150">
                              @for (role of element.roles; track $index) {
                              {{ role | roleFormatter }} - }
                            </span>
                          </td>
                        </ng-container>

                        <ng-container matColumnDef="status">
                          <th mat-header-cell *matHeaderCellDef>Observación</th>
                          <td mat-cell *matCellDef="let element">
                            <!-- @if (element.status | statusFormatter; as
                            formattedStatus) {
                            <span
                              class="daxa-badge d-inline-block"
                              [ngClass]="formattedStatus.class"
                            >
                              {{ formattedStatus.label }}
                            </span>
                            } -->
                          </td>
                        </ng-container>

                        <ng-container matColumnDef="actions" stickyEnd>
                          <th
                            mat-header-cell
                            *matHeaderCellDef
                            class="text-center"
                          >
                            Acciones
                          </th>
                          <td mat-cell *matCellDef="let element">
                            <div class="action-info">
                              @for (actionButton of element.actions; track
                              $index) {
                              <button
                                type="button"
                                mat-button
                                [matTooltip]="actionButton.label"
                                matTooltipPosition="above"
                                (click)="onActionButton(actionButton, element)"
                              >
                                <i class="material-symbols-outlined">
                                  {{ actionButton.name }}
                                </i>
                              </button>
                              }
                            </div>
                          </td>
                        </ng-container>

                        <tr
                          mat-header-row
                          *matHeaderRowDef="displayColumns; sticky: true"
                        ></tr>
                        <tr
                          mat-row
                          *matRowDef="let row; columns: displayColumns"
                        ></tr>
                      </table>
                    </div>

                    <div class="mt-10">
                      <mat-paginator
                        [length]="totalCount"
                        [pageSizeOptions]="defaultPageSize"
                        (page)="onPageChange($event)"
                      ></mat-paginator>
                    </div>
                  </div>
                </mat-card-content>
              </mat-card>
            </div>
          </div>
        </mat-tab>
        <mat-tab label="Calendario" [tabIndex]="1">

          <full-calendar [options]="calendarOptions"></full-calendar>

        </mat-tab>
        <mat-tab label="Documentos" [tabIndex]="2">

          <div class="mb-20">
            <file-upload
              class="file-uploader"
              [control]="fileUploadControl"
              [multiple]="false"
            ></file-upload>
          </div>

        </mat-tab>
      </mat-tab-group>
    </mat-card>
  </div>
</div>
}
